# ðŸš€ Render.com Configuration - Quick Reference

## Current Issue: Wrong Start Command

Your deployment is failing because Render is trying to run **`npm run dev`** (Node.js), but this is a **Python** project.

---

## âœ… SOLUTION: Update Render Settings

Go to your Render dashboard and update these settings:

### 1ï¸âƒ£ Service Settings (Dashboard â†’ Settings)

**Build Command:**
```bash
pip install -r requirements.txt
```

**Start Command:**
```bash
uvicorn dashboard.app:app --host 0.0.0.0 --port $PORT
```

### 2ï¸âƒ£ Environment Tab

Add these environment variables if not already set:

| Key | Value |
|-----|-------|
| `PYTHON_VERSION` | `3.11.4` |
| `PORT` | (auto-generated by Render) |

---

## ðŸ”„ Alternative: Use render.yaml (Automatic)

I've added `render.yaml` to your repository. Render should automatically detect it.

**To enable automatic configuration:**

1. Go to Render Dashboard
2. Delete the current service
3. Click **"New +"** â†’ **"Web Service"**
4. Select "Use Infrastructure as Code"
5. Choose your repository
6. Render will read `render.yaml` automatically

---

## ðŸ“‹ Manual Steps (If render.yaml doesn't work)

### Step 1: Access Service Settings

1. Go to [Render Dashboard](https://dashboard.render.com/)
2. Click on your `Retina-Unet` service
3. Click **"Settings"** tab

### Step 2: Update Build & Start Commands

Scroll to **"Build & Deploy"** section:

- **Build Command:** `pip install -r requirements.txt`
- **Start Command:** `uvicorn dashboard.app:app --host 0.0.0.0 --port $PORT`

Click **"Save Changes"**

### Step 3: Manual Deploy

- Click **"Manual Deploy"** â†’ **"Deploy latest commit"**
- Wait for build to complete (~5 minutes)
- Check logs for success

---

## ðŸŽ¯ Expected Deployment Flow

```
1. Build starts
   â†“
2. Installing Python 3.11.4
   â†“
3. Running: pip install -r requirements.txt
   â†“
4. Installing torch, fastapi, uvicorn, etc. (~5 min)
   â†“
5. Build successful âœ…
   â†“
6. Running: uvicorn dashboard.app:app --host 0.0.0.0 --port $PORT
   â†“
7. Model loading (with Git LFS checkpoint)
   â†“
8. Service LIVE at https://retina-unet.onrender.com ðŸŽ‰
```

---

## ðŸ” Troubleshooting

### Still seeing "npm run dev" error?

**Option A: Clear Build Cache**
1. Settings â†’ Build & Deploy
2. Click "Clear build cache"
3. Manual Deploy â†’ Deploy latest commit

**Option B: Delete & Recreate Service**
1. Delete current service
2. Create new service from GitHub
3. Render will detect `render.yaml` automatically

### Build succeeds but app crashes?

Check logs for:
- âœ… `Model architecture created`
- âœ… `Checkpoint loaded successfully` (if Git LFS worked)
- âš ï¸ `WARNING: No checkpoint found` (acceptable, will use random weights)

---

## ðŸ“Š What You Should See in Logs (Success)

```
==> Installing Python version 3.11.4...
==> Running build command 'pip install -r requirements.txt'...
Successfully installed fastapi uvicorn torch torchvision ...
==> Build successful ðŸŽ‰
==> Running 'uvicorn dashboard.app:app --host 0.0.0.0 --port $PORT'
INFO:     Started server process
INFO:     Waiting for application startup.
Using device: cpu
Model architecture created
Loading checkpoint from: /opt/render/project/src/results/checkpoints_unetpp/best.pth
Checkpoint loaded successfully
[SUCCESS] Model loaded! Checkpoint: Epoch 10, Dice: 0.8367
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:10000
==> Your service is live at https://retina-unet.onrender.com ðŸŽ‰
```

---

## ðŸŽ‰ After Successful Deployment

Visit your app:
- **Landing Page:** https://retina-unet.onrender.com/
- **Dashboard:** https://retina-unet.onrender.com/dashboard
- **API Docs:** https://retina-unet.onrender.com/docs

---

## ðŸ’¡ Important Notes

1. **First Request Delay (Free Tier):**
   - Service spins down after 15 min inactivity
   - First request takes ~50 seconds to wake up
   - Subsequent requests are instant

2. **Git LFS Bandwidth:**
   - Free tier: 1 GB/month bandwidth
   - Each deployment downloads the model (~104 MB)
   - ~9 deployments per month limit

3. **Memory Usage:**
   - Free tier: 512 MB RAM
   - App needs ~1-2 GB with model
   - May need to upgrade for production

---

## ðŸ“ž Need Help?

1. Check Render logs: Dashboard â†’ Logs
2. Review `DEPLOYMENT.md` for full guide
3. Contact support or check Render documentation

---

**Last Updated:** November 11, 2025  
**Commit:** ba36094 (Git LFS enabled)
