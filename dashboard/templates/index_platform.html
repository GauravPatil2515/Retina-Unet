<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="theme-color" content="#DC1449">
    <title>RetinaAI - Medical Vessel Segmentation Platform</title>
    <link rel="stylesheet" href="/static/style_platform.css">
    <link rel="stylesheet" href="/static/style_platform_mobile.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Mobile Header (Hamburger Menu) -->
    <header class="mobile-header">
        <div class="logo">
            <svg width="28" height="28" viewBox="0 0 32 32" fill="none">
                <circle cx="16" cy="16" r="14" stroke="#DC1449" stroke-width="2"/>
                <path d="M12 16 C12 16, 14 12, 16 12 S20 16, 20 16 S18 20, 16 20 S12 16, 12 16" stroke="#DC1449" stroke-width="1.5" fill="none"/>
                <circle cx="16" cy="16" r="2" fill="#DC1449"/>
            </svg>
            <span class="logo-text">RetinaAI</span>
        </div>
        <button class="hamburger" id="hamburger" aria-label="Toggle menu">
            <span></span>
            <span></span>
            <span></span>
        </button>
    </header>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    <!-- Left Sidebar Navigation -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                    <circle cx="16" cy="16" r="14" stroke="#C2185B" stroke-width="2"/>
                    <path d="M12 16 C12 16, 14 12, 16 12 S20 16, 20 16 S18 20, 16 20 S12 16, 12 16" stroke="#C2185B" stroke-width="1.5" fill="none"/>
                    <circle cx="16" cy="16" r="2" fill="#C2185B"/>
                </svg>
                <span class="logo-text">RetinaAI</span>
            </div>
            <div class="version">v1.0 Pro</div>
        </div>

        <nav class="sidebar-nav">
            <a href="#" class="nav-item active" data-page="dashboard">
                <svg class="nav-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"/>
                </svg>
                <span>Dashboard</span>
            </a>
            <a href="#" class="nav-item" data-page="info">
                <svg class="nav-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"/>
                </svg>
                <span>Information</span>
            </a>
            <a href="/" class="nav-item">
                <svg class="nav-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/>
                </svg>
                <span>Back to Home</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <div class="model-status">
                <div class="status-indicator online"></div>
                <div class="status-text">
                    <div class="status-title">Model Active</div>
                    <div class="status-subtitle">U-Net++ v2.0</div>
                </div>
            </div>
            <div class="quick-stats">
                <div class="quick-stat">
                    <div class="quick-stat-label">Accuracy</div>
                    <div class="quick-stat-value">96.08%</div>
                </div>
                <div class="quick-stat">
                    <div class="quick-stat-label">Processing</div>
                    <div class="quick-stat-value">&lt;1s</div>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Page -->
        <div id="page-dashboard" class="page active">
            <div class="page-header">
                <h1 class="page-title">Analysis Dashboard</h1>
                <p class="page-subtitle">Upload retinal fundus images for AI-powered blood vessel segmentation analysis</p>
            </div>

            <!-- Performance Metrics (Compact) -->
            <div class="metrics-grid-compact">
                <div class="metric-card">
                    <div class="metric-header">
                        <div class="metric-label">Dice Coefficient</div>
                        <div class="metric-tooltip" title="Overlap measure">ⓘ</div>
                    </div>
                    <div class="metric-value">83.82%</div>
                    <div class="metric-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 83.82%"></div>
                        </div>
                        <div class="progress-range">Target: 78-85%</div>
                    </div>
                    <canvas class="sparkline" id="sparkline-dice" width="200" height="40"></canvas>
                </div>

                <div class="metric-card">
                    <div class="metric-header">
                        <div class="metric-label">Accuracy</div>
                        <div class="metric-tooltip" title="Pixel classification">ⓘ</div>
                    </div>
                    <div class="metric-value">96.08%</div>
                    <div class="metric-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 96.08%"></div>
                        </div>
                        <div class="progress-range">Target: 94-96%</div>
                    </div>
                    <canvas class="sparkline" id="sparkline-accuracy" width="200" height="40"></canvas>
                </div>

                <div class="metric-card">
                    <div class="metric-header">
                        <div class="metric-label">Sensitivity</div>
                        <div class="metric-tooltip" title="True positive rate">ⓘ</div>
                    </div>
                    <div class="metric-value">82.91%</div>
                    <div class="metric-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 82.91%"></div>
                        </div>
                        <div class="progress-range">Target: 75-82%</div>
                    </div>
                    <canvas class="sparkline" id="sparkline-sensitivity" width="200" height="40"></canvas>
                </div>

                <div class="metric-card">
                    <div class="metric-header">
                        <div class="metric-label">Specificity</div>
                        <div class="metric-tooltip" title="True negative rate">ⓘ</div>
                    </div>
                    <div class="metric-value">97.97%</div>
                    <div class="metric-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 97.97%"></div>
                        </div>
                        <div class="progress-range">Target: 96-98%</div>
                    </div>
                    <canvas class="sparkline" id="sparkline-specificity" width="200" height="40"></canvas>
                </div>
            </div>

            <!-- Upload and Results Section -->
            <div class="dashboard-content">
                <div class="upload-section">
                    <div class="card upload-card">
                        <h2 class="card-title">Upload Retinal Image</h2>
                        <div class="upload-zone" id="uploadZone">
                            <svg class="upload-icon" width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                            </svg>
                            <p class="upload-text">Drag & drop retinal image here</p>
                            <p class="upload-subtext">or click to browse your files</p>
                            <div class="upload-formats">
                                <span class="format-badge">PNG</span>
                                <span class="format-badge">JPG</span>
                                <span class="format-badge">JPEG</span>
                                <span class="format-badge">TIFF</span>
                            </div>
                            <input type="file" id="imageInput" accept="image/*" hidden>
                        </div>
                        <div id="loadingIndicator" class="loading-indicator" style="display: none;">
                            <div class="spinner"></div>
                            <p>Processing image...</p>
                        </div>
                    </div>

                    <div id="resultsPreview" class="card results-preview" style="display: none;">
                        <h3 class="card-title">Quick Preview</h3>
                        <div class="preview-grid">
                            <div class="preview-item">
                                <img id="previewOriginal" alt="Original">
                                <span>Original</span>
                            </div>
                            <div class="preview-item">
                                <img id="previewSegmentation" alt="Segmentation">
                                <span>Vessels</span>
                            </div>
                        </div>
                        <button class="btn btn-primary btn-block" onclick="showFullResults()">View Full Results</button>
                    </div>
                </div>

                <div class="recent-uploads-sidebar">
                    <div class="card">
                        <h3 class="card-title">Recent Uploads</h3>
                        <div id="recentList" class="recent-list">
                            <p class="empty-state">No recent analyses</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Full Results Modal -->
            <div id="resultsModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Analysis Results</h2>
                        <button class="modal-close" onclick="closeResults()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="results-grid">
                            <div class="result-panel">
                                <h3>Original Image</h3>
                                <img id="resultOriginal" alt="Original">
                            </div>
                            <div class="result-panel">
                                <h3>Probability Map</h3>
                                <img id="resultProbability" alt="Probability">
                            </div>
                            <div class="result-panel">
                                <h3>Binary Segmentation</h3>
                                <img id="resultBinary" alt="Binary">
                            </div>
                            <div class="result-panel">
                                <h3>Overlay View</h3>
                                <img id="resultOverlay" alt="Overlay">
                            </div>
                        </div>
                        <div class="results-stats">
                            <div class="stat-item">
                                <span class="stat-label">Vessel Coverage</span>
                                <span class="stat-value" id="statCoverage">-</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Mean Confidence</span>
                                <span class="stat-value" id="statConfidence">-</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Processing Time</span>
                                <span class="stat-value" id="statTime">-</span>
                            </div>
                        </div>
                        <div class="modal-actions">
                            <button class="btn btn-secondary" onclick="downloadResults()">Download Results</button>
                                                        <button class="btn btn-primary" onclick="saveToHistory()">Save to History</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="/static/script_platform.js"></script>
</body>
</html>
